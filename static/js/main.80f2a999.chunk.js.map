{"version":3,"sources":["components/line-chart.js","utils/set-diff.js","utils/data-format.js","App.js","serviceWorker.js","index.js"],"names":["distinguishableColors","CoronaChart","props","renderCustomizedLegend","payload","currentCountry","countryHeader","className","style","marginBottom","map","entry","country","dataKey","color","label","active","state","disabled","includes","marginRight","onClick","handleClick","width","height","cx","cy","type","size","fill","scale","this","setState","filter","obj","concat","forceUpdate","dataPoints","data","handleOptionChange","id","name","value","checked","margin","top","right","left","bottom","chartLines","chartLine","connectNulls","stroke","yAxisId","dot","r","textAnchor","tick","angle","fontSize","padding","yLabelPrioritizedKeys","domain","allowDataOverflow","formatter","filterNull","wrapperStyle","borderColor","boxShadow","contentStyle","backgroundColor","labelStyle","fontWeight","align","content","a","b","countries","prevCountries","prev","Set","current","removedCountries","x","has","i","length","push","splice","indexOf","removed","removedCountry","pop","maxPerDataKey","Object","keys","key","sort","sorted","calcPrioritizedKeys","Component","formatStringToNumberOrNull","strigWithNumber","Number","endpoint","initialCountries","parseData","input","newExtraction","dataPerLine","String","split","header","firstDataPointPerPlace","line","date","place","newCases","newDeaths","totalCases","totalDeaths","dateFormatted","Date","toISOString","substring","currentData","values","localeCompare","customStyles","option","provided","isSelected","App","selectableCountries","currentCountries","multiCountryData","newParsed","newParsedData","multiData","includeDataPointsGoingForward","dataPoint","filteredDataPoint","axios","get","res","parsed","labels","getData","href","isMulti","options","onChange","_onChange","defaultValue","styles","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.80f2a999.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport { setDifference } from \"../utils/set-diff\";\nimport {\n  Legend,\n  Label,\n  Line,\n  LineChart,\n  ResponsiveContainer,\n  Surface, \n  Symbols,\n  Tooltip,\n  XAxis,\n  YAxis\n} from \"recharts\";\n\nconst distinguishableColors = [\n  '#FFFFFF', \n  '#F0A3FF',\n  '#0075DC',\n  '#993F00',\n  '#005C31',\n  '#2BCE48',\n  '#FFCC99',\n  '#808080',\n  '#94FFB5',\n  '#8F7C00',\n  '#9DCC00',\n  '#C20088',\n  '#FFA405',\n  '#FFA8BB',\n  '#426600',\n  '#FF0010',\n  '#5EF1F2',\n  '#00998F',\n  '#E0FF66',\n  '#740AFF',\n  '#990000',\n  '#FFFF80',\n  '#FFFF00',\n  '#FF5005'\n]\n\nconst calcPrioritizedKeys = (dataPoints, countries) => {\n  const maxPerDataKey = {}\n  for (const country of countries) {\n    maxPerDataKey[`newCases${country}`] = 0\n    maxPerDataKey[`totalCases${country}`] = 0\n    maxPerDataKey[`totalDeaths${country}`] = 0\n    maxPerDataKey[`newDeaths${country}`] = 0\n    for (const entry of dataPoints) {\n      if (entry[`newCases${country}`] > maxPerDataKey[`newCases${country}`]) {\n        maxPerDataKey[`newCases${country}`] = entry[`newCases${country}`]\n      }\n      if (entry[`totalCases${country}`] > maxPerDataKey[`totalCases${country}`]) {\n        maxPerDataKey[`totalCases${country}`] = entry[`totalCases${country}`]\n      }\n      if (entry[`totalDeaths${country}`] > maxPerDataKey[`totalDeaths${country}`]) {\n        maxPerDataKey[`totalDeaths${country}`] = entry[`totalDeaths${country}`]\n      }\n      if (entry[`newDeaths${country}`] > maxPerDataKey[`newDeaths${country}`]) {\n        maxPerDataKey[`newDeaths${country}`] = entry[`newDeaths${country}`]\n      }\n    }\n  }\n  const sortedKeys = Object.keys(maxPerDataKey).map(key => {\n    return {key, value: maxPerDataKey[key]}\n  // Sort descending on value\n  }).sort((a, b) => {\n    return b.value - a.value\n  })\n  return sortedKeys.map(sorted => sorted.key)\n}\n\nclass CoronaChart extends Component {\n  constructor(props) {\n    super(props) \n    this.state = {scale: 'linear'}\n  }\n\n  handleClick(dataKey) {\n    if (this.state.disabled.includes(dataKey)) {\n      this.setState({disabled: this.state.disabled.filter(obj => obj !== dataKey)})\n    } else {\n      this.setState({ disabled: this.state.disabled.concat(dataKey) });\n    }\n  }\n\n\n  handleOptionChange(scale) {\n    this.setState({\n      scale\n    });\n    this.forceUpdate()\n  }\n\n  renderCustomizedLegend = ({ payload }) => {\n    let currentCountry = ''\n    let countryHeader = null\n    return (\n      <div className=\"customized-legend\" style={{marginBottom: 40}}>\n        {payload.map(entry => {\n          if (currentCountry !== entry.country) {\n            currentCountry = entry.country\n            countryHeader = \n            <span className=\"Legend-country\">\n              <br/>\n              {entry.country}\n              <br/>\n            </span>\n          } else {\n            countryHeader = null\n          }\n          const { dataKey, color, label } = entry;\n          const active = this.state.disabled.includes(dataKey);\n          const style = {\n            marginRight: 10,\n            color: active ? \"#000\" : \"#AAA\",\n          };\n\n          return (\n           <span>\n            {countryHeader}\n            <span\n              onClick={() => this.handleClick(dataKey)}\n              style={style}\n            >\n              <Surface width={20} height={20} style={{marginBottom: -4}}>\n                <Symbols cx={10} cy={10} type=\"circle\" size={50} fill={color} />\n                {active && (\n                  <Symbols\n                    cx={10}\n                    cy={10}\n                    type=\"circle\"\n                    size={25}\n                    fill={\"#FFF\"}\n                  />\n                )}\n              </Surface>\n              <span className=\"Legend-per-country\">{label}</span>\n            </span>\n            </span> \n          );\n        })}\n      </div>\n    );\n  };\n\n  static getDerivedStateFromProps(props, state) {\n    const { dataPoints, countries } = props\n    if (!dataPoints || state.prevCountries === countries) {\n      return null\n    }\n\n    if (state.prevCountries) {\n      const prev = new Set(state.prevCountries)\n      const current = new Set(countries)\n  \n      const removedCountries = setDifference(prev, current)\n      // Push the old used colors back into the available pool\n      // Remove chartLines if country no longer selected\n      for (let i = state.chartLines.length - 1; i >= 0; i--) {\n        if (removedCountries.has(state.chartLines[i].country)) {\n          distinguishableColors.push(state.chartLines[i].color)\n          state.chartLines.splice(state.chartLines.indexOf(state.chartLines[i]), 1)\n        }\n      }\n\n      // Remove disabled lengends if country no longer selected\n      for (let i = state.disabled.length - 1; i >= 0; i--) {\n        let removed = false\n        for (const removedCountry of removedCountries) {\n          if (state.disabled[i].includes(removedCountry)) {\n            removed = true\n          }\n        }\n        if (removed) {\n          state.disabled.splice(state.disabled.indexOf(state.disabled[i]), 1)\n        }\n      }\n    }\n    \n    const chartLines = state.chartLines || []\n    const disabled = state.disabled || []\n    for (const country of countries) {\n      if (!state.prevCountries || (state.prevCountries && !state.prevCountries.includes(country))) {\n        chartLines.push({ country, dataKey: `newCases${country}`, color: distinguishableColors.pop(), label: `New cases`})\n        chartLines.push({ country, dataKey: `newDeaths${country}`, color: distinguishableColors.pop(), label: `New deaths`})\n        chartLines.push({ country, dataKey: `totalCases${country}`, color: distinguishableColors.pop(), label: `Total cases`})\n        chartLines.push({ country, dataKey: `totalDeaths${country}`, color: distinguishableColors.pop(), label: `Total deaths`})\n        disabled.push(`totalCases${country}`)\n        disabled.push(`totalDeaths${country}`)\n      }\n    }\n\n    const yLabelPrioritizedKeys = calcPrioritizedKeys(dataPoints, countries)\n\n    return {\n      chartLines, disabled, prevCountries: countries, yLabelPrioritizedKeys\n    }\n  }\n\n\n  render() {\n    const { dataPoints } = this.props\n\n    if (!dataPoints) {\n      return null;\n    }\n    \n    const data = dataPoints\n\n    return (\n      <div>\n        <div>\n          <span\n            onClick={() => this.handleOptionChange(\"linear\")}>\n            <input type=\"radio\" id=\"linear\" name=\"scale\" value=\"linear\" checked={this.state.scale === 'linear'} />\n            <span style={{color: \"#AAA\"}}>Linear</span>\n          </span>\n          <span\n            onClick={() => this.handleOptionChange(\"log\")}>\n            <input type=\"radio\" id=\"log\" name=\"scale\" value=\"log\" checked={this.state.scale === 'log'}/>\n            <span style={{color: \"#AAA\"}}>Log</span>\n          </span>\n        </div>\n      <ResponsiveContainer height={800} className=\"chart-container\">\n        <LineChart\n          width={800}\n          height={800}\n          data={data}\n          margin={{ top: 25, right: 25, left: 40, bottom: 25 }}\n          >\n          {\n            this.state.chartLines.filter(chartLine => !this.state.disabled.includes(chartLine.dataKey)).map(chartLine =>\n              <Line\n              connectNulls\n              name={chartLine.label}\n              type=\"monotone\"\n              dataKey={chartLine.dataKey}\n              stroke={chartLine.color}\n              yAxisId={0}\n              dot={{r: 2}}\n              />\n              )\n            }\n          <XAxis\n            dataKey=\"date\"\n            textAnchor=\"end\"\n            tick={{ angle: -70, fontSize: 20 }}\n            height={225}\n            padding={{right: 3, left: 3}}\n            />\n\n          <YAxis\n            dataKey={this.state.yLabelPrioritizedKeys.filter(dataKey => !this.state.disabled.includes(dataKey))[0]}\n            domain={this.state.scale === 'log' ? [1, 'dataMax'] : [0, 'dataMax']}\n            tick={{ fontSize: 20 }}\n            width={40}\n            scale={this.state.scale}\n            allowDataOverflow\n            padding={{top: 3, bottom: 3}}\n            >\n             {/* <Label value=\"Persons\" angle={-90} position=\"insideBottomLeft\" offset={1} style={{ fontSize: '80%', fill: 'rgba(0, 204, 102, 0.70)' }}></Label> */}\n          />\n          </YAxis>\n          <Tooltip\n            formatter={(value, name) => (value === null) ? 0 : value}\n            filterNull={false}\n            wrapperStyle={{\n              borderColor: \"white\",\n              boxShadow: \"2px 2px 3px 0px rgb(204, 204, 204)\"\n            }}\n            contentStyle={{ backgroundColor: \"rgba(255, 255, 255, 0.8)\" }}\n            labelStyle={{ fontWeight: \"bold\", color: \"#666666\" }}\n            />\n          <Legend wrapperStyle={{top: 550}} align='center' height={100} content={this.renderCustomizedLegend} \n            payload={this.state.chartLines}/>\n        </LineChart>\n      </ResponsiveContainer>\n    </div>\n    );\n  }\n}\n\nexport default CoronaChart;\n","export const setDifference = (a, b) => new Set([...a].filter(x => !b.has(x)));","export const formatStringToNumberOrNull = (strigWithNumber) => {\n  return Number(strigWithNumber) === 0 ? null : Number(strigWithNumber)\n}","import React, { Component } from \"react\";\nimport \"./App.css\";\nimport axios from \"axios\";\nimport CoronaChart from \"./components/line-chart\";\nimport { formatStringToNumberOrNull } from \"./utils/data-format\";\n\nimport Select from 'react-select';\n\nconst endpoint = \"https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/ecdc/full_data.csv\";\nconst initialCountries = [{value: 'Italy', label: 'Italy'}, {value: 'Spain', label: 'Spain'}]\n\nconst parseData = (input) => {\n  const newExtraction = {}\n  const countries = {}\n  const dataPerLine = String(input).split('\\n')\n  let header = true\n  const firstDataPointPerPlace = {}\n  for (const line of dataPerLine) {\n    if (header) {\n      header = false\n      continue\n    }\n    const [date, place, newCases, newDeaths, totalCases, totalDeaths] = line.split(',')\n    if (!place) {\n      continue\n    }\n    countries[place] = true\n    if (!firstDataPointPerPlace[place]) {\n      if (Number(newCases) === 0 &&\n          Number(newDeaths) === 0 &&\n          Number(totalCases) === 0 &&\n          Number(totalDeaths) === 0) {\n        continue\n      } else {\n        firstDataPointPerPlace[place] = true\n      }\n    }\n    const dateFormatted = new Date(date).toISOString().substring(0,10)\n    if (!newExtraction[dateFormatted]) {\n      newExtraction[dateFormatted] = {\n        date: dateFormatted,\n        [`newCases${place}`]: formatStringToNumberOrNull(newCases),\n        [`newDeaths${place}`]: formatStringToNumberOrNull(newDeaths),\n        [`totalCases${place}`]: formatStringToNumberOrNull(totalCases), \n        [`totalDeaths${place}`]: formatStringToNumberOrNull(totalDeaths)\n      }\n    } else {\n      const currentData = newExtraction[dateFormatted]\n      newExtraction[dateFormatted] = {\n        [`newCases${place}`]: formatStringToNumberOrNull(newCases),\n        [`newDeaths${place}`]: formatStringToNumberOrNull(newDeaths),\n        [`totalCases${place}`]: formatStringToNumberOrNull(totalCases), \n        [`totalDeaths${place}`]: formatStringToNumberOrNull(totalDeaths), \n        ...currentData\n      }\n    }\n  }\n\n  // Resort the data on date\n  const dataPoints = Object.values(newExtraction).sort((a, b) => {\n    return a.date.localeCompare(b.date)\n  })\n\n  return [dataPoints, Object.keys(countries)]\n}\n\nconst customStyles = {\n  option: (provided, state) => ({\n    ...provided,\n    color: state.isSelected ? 'orange' : 'black',\n  })\n}\n\nclass App extends Component {\n  state = {\n    selectableCountries: initialCountries,\n    currentCountries: initialCountries\n  }\n\n  async getData(countries) {\n    if (!countries) {\n      this.setState({currentCountries: [], multiCountryData: null })\n      return\n    }\n    const newParsed = this.state.newParsedData\n    let multiData = []\n    if (countries) {\n      // Build data set with only the selected countries and only after they started getting data\n      let includeDataPointsGoingForward = false\n      for (const dataPoint of Object.values(newParsed)) {\n        for (const country of countries) {\n          if (dataPoint[`newCases${country.value}`]) {\n            includeDataPointsGoingForward = true\n            break\n          }\n        }\n        if (includeDataPointsGoingForward) {\n          const filteredDataPoint = {}\n          for (const country of countries) {\n            filteredDataPoint[`newCases${country.value}`] = dataPoint[`newCases${country.value}`] || null\n            filteredDataPoint[`newDeaths${country.value}`] = dataPoint[`newDeaths${country.value}`] || null\n            filteredDataPoint[`totalCases${country.value}`] = dataPoint[`totalCases${country.value}`] || null\n            filteredDataPoint[`totalDeaths${country.value}`] = dataPoint[`totalDeaths${country.value}`] || null\n          }\n          filteredDataPoint['date'] = dataPoint['date']\n          multiData.push(filteredDataPoint)\n        }\n      }\n    }\n\n    this.setState({currentCountries: countries, multiCountryData: multiData })\n    \n  }\n\n  async componentDidMount() {\n    const res = await axios.get(`${endpoint}`);\n    const [parsed, countries] = parseData(res.data)\n    const labels = countries.map(key => ({value: key, label: key}))\n    this.setState({selectableCountries: labels, newParsedData: parsed})\n    await this.getData(initialCountries);\n  }\n\n  async _onChange(countries) {\n    await this.getData(countries)\n  }\n\n  render() {\n    const { selectableCountries, currentCountries, multiCountryData } = this.state;\n    return (\n      <div className=\"App\">\n        <div className=\"Top-left\">Source code on: <a href={\"https://github.com/mathiastj/corona-graphs\"}>Github</a></div>\n        <div className=\"Top-right\">Sources: ECDC via <a href={endpoint}>OWID</a> under <a href=\"https://creativecommons.org/licenses/by/4.0/\">CC BY 4.0</a></div>\n        <header className=\"App-header\">\n          <div style={{width: '75%'}}>\n            <Select isMulti options={selectableCountries} onChange={input => this._onChange(input)} defaultValue={initialCountries} styles={customStyles} value={currentCountries}/>\n          </div>\n          <div style={{width: '95%', height: '90%'}}>\n            <CoronaChart dataPoints={multiCountryData} countries={currentCountries.map(country => country.value)}/> \n          </div>\n        </header>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n)\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (response.status === 404 || (contentType != null && contentType.indexOf('javascript') === -1)) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.')\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister()\n      })\n      .catch(error => {\n        console.error(error.message)\n      })\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}